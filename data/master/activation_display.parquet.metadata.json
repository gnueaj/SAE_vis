{
  "created_at": "2025-11-07T02:10:01.718362",
  "script_version": "1.0",
  "sae_id": "google--gemma-scope-9b-pt-res--layer_30--width_16k--average_l0_120",
  "total_rows": 16375,
  "schema": {
    "feature_id": "UInt32",
    "sae_id": "Categorical",
    "pattern_type": "Categorical",
    "semantic_similarity": "Float32",
    "char_ngram_max_jaccard": "Float32",
    "word_ngram_max_jaccard": "Float32",
    "top_char_ngram_text": "Utf8",
    "top_word_ngram_text": "Utf8",
    "quantile_examples": "List(Struct([Field('quantile_index', Int64), Field('prompt_id', Int64), Field('prompt_tokens', List(Utf8)), Field('activation_pairs', List(Struct([Field('token_position', Int64), Field('activation_value', Float64)]))), Field('max_activation', Float64), Field('max_activation_position', Int64), Field('char_ngram_positions', List(Struct([Field('token_position', Int64), Field('char_offset', Int64)]))), Field('word_ngram_positions', List(Int64))]))"
  },
  "processing_stats": {
    "features_processed": 16375,
    "features_with_no_data": 1,
    "features_with_invalid_boundaries": 8,
    "total_examples_processed": 130594,
    "semantic_patterns": 2864,
    "lexical_patterns": 4325,
    "both_patterns": 927,
    "no_patterns": 8259
  },
  "result_stats": {
    "features_with_data": 16375,
    "pattern_distribution": {
      "semantic": 2864,
      "lexical": 4325,
      "both": 927,
      "none": 8259
    },
    "mean_semantic_similarity": 0.24969873112349109,
    "mean_char_ngram_jaccard": 0.3199018638925129,
    "mean_word_ngram_jaccard": 0.20926905675585034,
    "mean_examples_per_feature": 7.975206106870229
  },
  "config_used": {
    "activation_examples_path": "data/master/activation_examples.parquet",
    "activation_similarity_path": "data/master/activation_example_similarity.parquet",
    "output_path": "data/master/activation_display.parquet",
    "sae_id": "google--gemma-scope-9b-pt-res--layer_30--width_16k--average_l0_120",
    "processing_parameters": {
      "semantic_threshold": 0.3,
      "lexical_threshold": 0.4,
      "token_processing": {
        "remove_leading_underscore": true,
        "join_tokens": true
      }
    },
    "description": "Configuration for creating optimized activation display data with dual n-gram pattern classification",
    "schema_info": {
      "table_name": "activation_display",
      "version": "2.0",
      "field_descriptions": {
        "feature_id": "SAE feature index",
        "sae_id": "SAE model identifier",
        "pattern_type": "Pattern classification: Semantic, Lexical, Both, or None (uses separate thresholds for semantic and lexical)",
        "semantic_similarity": "Average pairwise semantic similarity",
        "char_ngram_max_jaccard": "Jaccard similarity for the most frequent character n-gram",
        "word_ngram_max_jaccard": "Jaccard similarity for the most frequent word n-gram",
        "top_char_ngram_text": "The actual character n-gram text (e.g., 'ing')",
        "top_word_ngram_text": "The actual word n-gram text (e.g., 'observation')",
        "quantile_examples": "Pre-organized activation examples (8 total, 2 per quantile) with token positions for n-gram highlighting"
      },
      "quantile_example_fields": {
        "quantile_index": "Quantile group (0-3) based on activation strength",
        "prompt_id": "Prompt identifier",
        "prompt_tokens": "Token array with '\u2581' prefix stripped",
        "activation_pairs": "List of (token_position, activation_value) pairs",
        "max_activation": "Maximum activation value",
        "max_activation_position": "Token position of max activation",
        "char_ngram_positions": "List of {token_position, char_offset} where top char n-gram appears (enables precise character-level highlighting within token)",
        "word_ngram_positions": "Token positions where top word n-gram starts (for word-level highlighting)"
      }
    },
    "processing_notes": {
      "expected_output_rows": 824,
      "pattern_classification": "Separate thresholds for semantic (avg_pairwise_semantic_similarity) and lexical ((char_jaccard OR word_jaccard))",
      "semantic_threshold": "Threshold for semantic pattern classification (default: 0.3)",
      "lexical_threshold": "Threshold for lexical pattern classification (char OR word Jaccard, default: 0.3)",
      "optimization": "Feature-level organization reduces load time from ~5s to ~20ms",
      "frontend_usage": "Positions enable visual highlighting of n-gram patterns in token display"
    }
  }
}