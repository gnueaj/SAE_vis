{
  "activation_examples_path": "data/master/activation_examples.parquet",
  "output_path": "data/master/activation_embeddings.parquet",
  "sae_id": "google--gemma-scope-9b-pt-res--layer_30--width_16k--average_l0_120",

  "description": "Configuration for pre-computing embeddings of activation examples",

  "processing_parameters": {
    "num_quantiles": 4,
    "examples_per_quantile": 4,
    "target_examples_per_feature": 16,
    "token_window_size": 32
  },

  "model_parameters": {
    "sentence_transformer_model": "google/embeddinggemma-300m",
    "device": "cuda",
    "batch_size": 512
  },

  "processing_notes": {
    "expected_features": 16384,
    "processing_strategy": "quantile_based_sampling",
    "embedding_purpose": "pre_compute_for_downstream_similarity_analysis",
    "window_extraction": "symmetric_with_asymmetric_fallback",
    "text_reconstruction": "Reconstructs natural readable text from subword tokens (strips '▁' prefix, joins subwords into full words)",
    "token_window_size_note": "32 tokens extracted BEFORE reconstruction, results in ~25-32 words after joining subwords",
    "primary_key_fields": [
      "feature_id",
      "sae_id"
    ]
  },

  "schema_info": {
    "table_name": "activation_embeddings",
    "version": "2.0",
    "field_descriptions": {
      "feature_id": "SAE feature index (0-16383)",
      "sae_id": "SAE model identifier",
      "prompt_ids": "List of prompt IDs selected via quantile sampling",
      "embeddings": "List of embeddings (768-dim vectors from google/embeddinggemma-300m) generated from natural readable text (not raw tokens)"
    },
    "version_changes": {
      "2.0": "Changed text preprocessing to reconstruct natural readable text from subword tokens (strips '▁', joins subwords). Embeddings now generated from 'the services of a...' instead of '▁the ▁service s ▁of ▁a...'"
    }
  },

  "performance_notes": {
    "embedding_dimension": 768,
    "expected_embeddings_per_feature": 16,
    "total_expected_embeddings": 0,
    "batch_processing": true,
    "downstream_consumers": [
      "9_activation_example_similarity.py"
    ]
  }
}
