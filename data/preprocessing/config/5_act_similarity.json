{
  "activation_examples_path": "data/master/activation_examples.parquet",
  "activation_embeddings_path": "data/master/activation_embeddings.parquet",
  "output_path": "data/master/activation_example_similarity.parquet",
  "sae_id": "google--gemma-scope-9b-pt-res--layer_30--width_16k--average_l0_120",

  "description": "Configuration for calculating activation example similarity metrics (semantic similarity and n-grams) using pre-computed embeddings",

  "processing_parameters": {
    "num_quantiles": 4,
    "examples_per_quantile": 2,
    "target_examples_per_feature": 8,
    "token_window_size": 32,
    "char_ngram_window_size": 3,
    "word_ngram_window_size": 11,
    "char_ngram_sizes": [2, 3, 4, 5],
    "word_ngram_sizes": [1, 2, 3],
    "min_ngram_occurrences": 2
  },

  "processing_notes": {
    "expected_features": 16384,
    "processing_strategy": "quantile_based_sampling",
    "handle_insufficient_examples": "use_all_available",
    "embeddings_source": "pre_computed_from_4_act_embeddings.py",
    "dependencies": [
      "4_act_embeddings.py must be run first"
    ],
    "primary_key_fields": [
      "feature_id",
      "sae_id"
    ]
  },

  "schema_info": {
    "table_name": "activation_example_similarity",
    "version": "3.0",
    "field_descriptions": {
      "feature_id": "SAE feature index (0-16383)",
      "sae_id": "SAE model identifier",
      "prompt_ids_analyzed": "List of prompt IDs selected for analysis",
      "num_total_activations": "Total number of activation examples for this feature",
      "avg_pairwise_semantic_similarity": "Average cosine similarity across all pairs of 32-token windows",
      "top_char_ngrams": "Most frequent character n-gram per size (2-5) extracted from individual tokens with '‚ñÅ' prefix stripped (3-token window around max activation)",
      "top_word_ngrams": "Most frequent word-level n-gram per size (1-3) reconstructed from subword tokens (11-token window around max activation)",
      "top_char_ngram": "Overall most frequent character n-gram (across all sizes 2-5) with all occurrence positions including char_offset within token (3-token window)",
      "top_word_ngram": "Overall most frequent word n-gram (across all sizes 1-3) with all occurrence positions (11-token window)",
      "top_char_ngram_jaccard": "Pairwise Jaccard similarity for the top character n-gram (single value)",
      "top_word_ngram_jaccard": "Pairwise Jaccard similarity for the top word n-gram (single value)",
      "quantile_boundaries": "Activation value thresholds for the 4 quantiles [q1, q2, q3]",
      "ngram_jaccard_similarity": "Average pairwise Jaccard similarity [2gram, 3gram, 4gram, 5gram] using per-token character extraction (legacy)"
    }
  }
}
