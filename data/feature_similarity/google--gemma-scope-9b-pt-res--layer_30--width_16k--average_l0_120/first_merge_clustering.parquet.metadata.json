{
  "created_at": "2025-11-30T01:12:10.344055",
  "script_version": "1.0",
  "sae_id": "google--gemma-scope-9b-pt-res--layer_30--width_16k--average_l0_120",
  "n_features": 14316,
  "linkage_method": "average",
  "schema": {
    "first_merge_clustering.parquet": {
      "feature_id": "int32 - Feature index (0 to n_features-1)",
      "first_merge_distance": "float32 - Distance threshold when feature first merges from singleton"
    },
    "clustering_linkage.npy": {
      "shape": "(14315, 4)",
      "format": "scipy linkage matrix",
      "columns": [
        "cluster1_id",
        "cluster2_id",
        "merge_distance",
        "cluster_size"
      ],
      "usage": "Use scipy.cluster.hierarchy.fcluster(linkage, t=threshold, criterion='distance') to get clusters"
    }
  },
  "processing_stats": {
    "n_features": 16384,
    "n_neighbors_loaded": 130269,
    "n_distances_filled": 63683258,
    "matrix_memory_mb": 781.8140258789062,
    "min_first_merge": 0.16301512718200684,
    "max_first_merge": 0.9968072605133057,
    "mean_first_merge": 0.7784967258349407,
    "clustering_time_seconds": 3.848905563354492,
    "total_processing_time_seconds": 0.0,
    "valid_features_filtered": true,
    "valid_features_source": "scores_dir",
    "original_n_features": 16384
  },
  "config_used": {
    "sae_id": "google--gemma-scope-9b-pt-res--layer_30--width_16k--average_l0_120",
    "input_path": "data/feature_similarity/google--gemma-scope-9b-pt-res--layer_30--width_16k--average_l0_120/feature_similarities.json",
    "output_dir": "data/feature_similarity/google--gemma-scope-9b-pt-res--layer_30--width_16k--average_l0_120",
    "output_files": {
      "first_merge_parquet": "first_merge_clustering.parquet",
      "linkage_matrix": "clustering_linkage.npy",
      "metadata": "first_merge_clustering.parquet.metadata.json"
    },
    "processing_parameters": {
      "linkage_method": "average",
      "default_distance": 1.0,
      "expected_n_features": 16384,
      "distance_thresholds": {
        "start": 0.0,
        "end": 1.0,
        "step": 0.01,
        "description": "Threshold values for potential cluster membership queries (not saved, but documented)"
      }
    },
    "valid_features_parquet": null,
    "description": "Configuration for agglomerative clustering of SAE features using decoder weight similarities",
    "valid_features_scores_dir": "data/scores"
  }
}