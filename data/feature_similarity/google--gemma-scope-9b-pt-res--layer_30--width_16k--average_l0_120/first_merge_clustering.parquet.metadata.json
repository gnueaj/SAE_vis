{
  "created_at": "2025-11-24T00:05:37.495229",
  "script_version": "1.0",
  "sae_id": "google--gemma-scope-9b-pt-res--layer_30--width_16k--average_l0_120",
  "n_features": 16384,
  "linkage_method": "average",
  "schema": {
    "first_merge_clustering.parquet": {
      "feature_id": "int32 - Feature index (0 to n_features-1)",
      "first_merge_distance": "float32 - Distance threshold when feature first merges from singleton"
    },
    "clustering_linkage.npy": {
      "shape": "(16383, 4)",
      "format": "scipy linkage matrix",
      "columns": [
        "cluster1_id",
        "cluster2_id",
        "merge_distance",
        "cluster_size"
      ],
      "usage": "Use scipy.cluster.hierarchy.fcluster(linkage, t=threshold, criterion='distance') to get clusters"
    }
  },
  "processing_stats": {
    "n_features": 16384,
    "n_neighbors_loaded": 163840,
    "n_distances_filled": 244996,
    "matrix_memory_mb": 1024.0,
    "min_first_merge": 0.16301512718200684,
    "max_first_merge": 0.99752201795578,
    "mean_first_merge": 0.7780123204212895,
    "clustering_time_seconds": 5.261319637298584,
    "total_processing_time_seconds": 0.0
  },
  "config_used": {
    "sae_id": "google--gemma-scope-9b-pt-res--layer_30--width_16k--average_l0_120",
    "input_path": "data/feature_similarity/google--gemma-scope-9b-pt-res--layer_30--width_16k--average_l0_120/feature_similarities.json",
    "output_dir": "data/feature_similarity/google--gemma-scope-9b-pt-res--layer_30--width_16k--average_l0_120",
    "output_files": {
      "first_merge_parquet": "first_merge_clustering.parquet",
      "linkage_matrix": "clustering_linkage.npy",
      "metadata": "first_merge_clustering.parquet.metadata.json"
    },
    "processing_parameters": {
      "linkage_method": "average",
      "default_distance": 1.0,
      "expected_n_features": 16384,
      "distance_thresholds": {
        "start": 0.0,
        "end": 1.0,
        "step": 0.01,
        "description": "Threshold values for potential cluster membership queries (not saved, but documented)"
      }
    },
    "description": "Configuration for agglomerative clustering of SAE features using decoder weight similarities"
  }
}